<% var count = 0 %>
<h1 class="title-header">Gestion Utilisateurs</h1>
<div id="block-gestion" class="block-gestion">
	<% if(req.session.match && req.session.match[0] == "email"){ %>
	<div class="errorSignup messageTop">
	Un compte avec ce mail : <%= req.session.match[1]%> existe déjà, veuillez en choisir un autre !!
	</div>
	<%  req.session.match = ""; %>
	<% }else if(req.session.match && req.session.match[0] == "pseudo"){ %>
	<div class="errorSignup messageTop">
	Ce pseudo : <%= req.session.match[2]%> est déjà utilisé !!
	</div>
	<%  req.session.match = ""; %>
	<% } else if(req.session.errSignup && req.session.errSignup == "signupIncomplete"){ %>
	<div class="errorSignup messageTop">
	Veuillez renseigner tout les champs !!
	</div>
	<% req.session.errSignup = ""; %>
	<%  } else if(req.session.errSignup && req.session.errSignup == "updated"){ %>
	<div class="created messageTop">
	Les modifications ont été réussies !!
	</div>
	<% req.session.errSignup = ""; %>
	<%  } else if(req.session.errSignup && req.session.errSignup == "badFormatMail"){ %>
	<div class="errorSignup messageTop">
	Le format du mail n'est pas bon !!
	</div>
	<% req.session.errSignup = ""; %>
	<% } %>
	<% if(update === 1) { %>
	<div class="created messageTop">
		Update success !
	</div>
	<% } else if(update === 2) { %>
	<div class="errorSignup messageTop">
		Update failed ! <%= msg %>
	</div>
	<% } %>
<div class="block-table">
	<table>
		<tr>
			<td class="title-table">Save</td>
			<td class="title-table">Picture</td>
			<td class="title-table">FirstName</td>
			<td class="title-table">LastName</td>
			<td class="title-table">Email</td>
			<td class="title-table">Pseudo</td>
			<td class="title-table">Active</td>
			<td class="title-table">codeActive</td>
			<% if(me.admin === 2) { %>
				<td class="title-table">Admin</td>
			<% } %>
			<td class="title-table">Language</td>
		</tr>
		<% listUsers.forEach(function(user, j){ %>
			<% count = j %>
			<tr>
				<form action="/Gestion/update" enctype="multipart/form-data" method="post">
					<td><button type="submit" name="action" value="update" class="btn-hp hvr-bounce-to-bottom" style="padding:8px;outline:none;">Modify</button></td>
					<td style="width:65px;">
						<div class="block-img hover-pic">
							<button type="submit" name="action" value="delete_pic" style="background:none;border:none;padding:0px;outline:none;"><img src="<%= !user.photo ? "/images/pic_default.jpg" : user.photo %>" alt="Picture <%= user.pseudo %>"/></button>
						</div>
					</td>
					<td><input id="firstName" name="firstName" type="text" value="<%= user.firstName %>"></td>
					<td><input id="lastName" name="lastName" type="text" value="<%= user.lastName %>"></td>
					<td><input id="email" name="email" type="text" value="<%= user.email %>"></td>
					<td><input id="pseudo" name="pseudo" type="text" value="<%= user.pseudo %>"></td>
					<td>
						<div style="text-align:center;font-size:1.5em;">
							<% if(user.active) { %>
								<button type="submit" name="action" value="desactive" class="btn-hp hvr-bounce-to-bottom" style="padding:0px;outline:none;"><i class="fa fa-check" style="color:#00e400;text-shadow:1px 1px 1px #333;" aria-hidden="true"></i></button>
							<% } else { %>
								<button type="submit" name="action" value="active" class="btn-hp hvr-bounce-to-bottom" style="padding:0px;outline:none;"><i class="fa fa-ban" style="color:red;text-shadow:1px 1px 1px #333;" aria-hidden="true"></i></button>

							<% } %>
						</div>
					</td>
					<td><input id="codeActive" name="codeActive" type="text" value="<%= user.codeActive %>"></td>
					<% if(me.admin === 2) { %>
					<td>
						<select class="btn-hp" name="permit" style="outline:none;font-size:1em;height:100%;">
							<% if(user.admin === 0) { %>
								<option value="member" selected>Member</option>
								<option value="admin">Admin</option>
							<% } else if(user.admin === 1) { %>
								<option value="member">Member</option>
								<option value="admin" selected>Admin</option>
							<% } else { %>
								<option value="member">Member</option>
								<option value="admin">Admin</option>
							<% } %>
						</select>
					</td>
					<% } %>
					<td>
						<select class="btn-hp" name="language" style="outline:none;font-size:1em;height:100%;">
							<% if(user.language === "Français") { %>
								<option value="English">English</option>
								<option value="Français" selected>Français</option>
							<% } else if(user.language === "English") { %>
								<option value="English" selected>English</option>
								<option value="Français">Français</option>
							<% } else { %>
								<option value="English">English</option>
								<option value="Français">Français</option>
							<% } %>
						</select>
					</td>
					<td hidden="hidden"><input id="id_user" name="id_user" type="text" value="<%= user.id %>" ></td>
				</form>
			</tr>
		<% }) %>
	</table>
</div>
</div>
<div class="pagination-block">
	<form id="form-pagination" action="/Gestion?page=" enctype="multipart/form-data" method="get">
		<% if(page > 1) { %>
			<button id="last" class="pagination-button" type="submit"><i class="fa fa-chevron-circle-left" aria-hidden="true"></i></button>
		<% } else { %>
			<button class="pagination-button" style="color:rgba(0,0,0,0);"><i class="fa fa-chevron-circle-left" aria-hidden="true"></i></button>
		<% } %>
		<input id="pagination" type="text" name="page" value="<%= page %>" class="pagination">
		<button id="GO" type="submit" hidden="hidden">GO</button>
		<% if(count === 9) { %>
			<button id="next" class="pagination-button" type="submit"><i class="fa fa-chevron-circle-right pagination-button" aria-hidden="true"></i></button>
		<% } else { %>
			<button class="pagination-button" style="color:rgba(0,0,0,0);"><i class="fa fa-chevron-circle-right" aria-hidden="true"></i></button>
		<% } %>
	</form>
</div>
<script src="/js/pagination.js"></script>
